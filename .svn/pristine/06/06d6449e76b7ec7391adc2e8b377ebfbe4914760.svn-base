<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>layuiAdmin 文章管理 iframe 框</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="{{asset('css/layui.css')}}" media="all">
    <style>
        .layui-form-label{width: 105px;}
        #addressDetail{width:590px;}
        .layui-input, .layui-textarea {width: 250px;}
        select{  border: none;  outline: none;  width: 100%;  height: 40px;  line-height: 40px;  appearance: none;  -webkit-appearance: none;  -moz-appearance: none;  padding-left: 10px;  border-width: 1px;  border-style: solid;  background-color: #fff;  border-radius: 2px;  border-color: #e6e6e6;  cursor: pointer;  }  select:hover{  border-color: #D2D2D2 !important;  }
        .obconts {
            width: 360px;
            position: relative;
            margin-top: 26px;
            height: 200px;
            border: 2px dotted #000;
            border-radius: 15px;
            margin-left: 20px;
            float: left;
        }
        .obconts p {
            font-size: 18px;
            font-weight: 700;
            color: #000;
            padding-left: 15px;
            padding-top: 5px;
            margin: 0 0 15px;
        }
        .obconts input[class=uploadfile] {
            width: 106px;
            height: 41px;
            position: relative;
            z-index: 9;
            opacity: 0;
            top: -37px;
            margin-left: 270px;
            left: -13px;
        }
        .obconts label {
            position: absolute;
            background: #232323;
            display: inline-block;
            color: #ffde00;
            width: 90px;
            height: 41px;
            line-height: 45px;
            text-align: center;
            top: 123px;
            left: 256px;
            border-radius: 5px;
        }
        input[type=file] {
            display: block;
        }
    </style>
</head>
<body>

<form action="{{url('user/receiver')}}" id="form1" enctype="multipart/form-data" method="post">
    <div class="layui-form" lay-filter="layuiadmin-app-form-list" id="layuiadmin-app-form-list" style="padding: 20px 30px 0 0;">
        {{csrf_field()}}
        <input type="hidden" name="id" value="{{$data['id']}}">
        <div class="layui-form-item">
            <label class="layui-form-label">* 姓名</label>
            <div class="layui-input-inline">
                <input type="text" name="name" lay-verify="chinese" lay-verType="tips" class="layui-input" autocomplete="on" placeholder="收件人姓名必须与身份证号保持一致" value="{{$data['name']}}">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">* 手机号码</label>
            <div class="layui-input-inline">
                <input type="text" name="phone" lay-verify="required|phone" lay-verType="tips" autocomplete="on"class="layui-input" placeholder="请输入收件人电话" value="{{$data['phone']}}">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">* 证件类型</label>
            <div class="layui-input-inline">
                <div class="layui-unselect layui-form-select">
                    <div class="layui-select-title">
                        <select name="cre_type" lay-verify="required" lay-ignore lay-verType="tips">
                            <option value="1">身份证</option>
                        </select>
                        <i class="layui-edge"></i>
                    </div>
                </div>
            </div>
            <div class="layui-input-inline">
                <input type="text" name="cre_num" lay-verify="required" lay-verType="tips" autocomplete="on" class="layui-input" value="{{$data['cre_num']}}" placeholder="身份证号必须与收件人姓名保持一致">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">* 地址</label>
            <div class="layui-input-block">

            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">* 详细地址</label>
            <div class="layui-input-block">
                <input type="text" id="addressDetail" name="addressDetail" lay-verify="required" lay-verType="tips" autocomplete="on" class="layui-input" placeholder="请输入收件人地址" value="{{$data['addressDetail']}}">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">* 邮编</label>
            <div class="layui-input-inline">
                <input type="text" name="code" lay-verify="required|number" lay-verType="tips" autocomplete="on" class="layui-input" placeholder="请输入收件人邮编" value="{{$data['code']}}">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label"> 标签<br>(可不填)</label>
            <div class="layui-input-inline">
                <input type="text" name="tag" lay-verType="tips" autocomplete="on" class="layui-input" placeholder="请输入收件人标识" value="{{$data['tag']}}">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label"> 默认线路<br>(可不选)</label>
            <div class="layui-input-inline">
                <div class="layui-unselect layui-form-select">
                    <div class="layui-select-title">
                        <select name="line_id" lay-ignore lay-verType="tips">
                                <option value="">默认邮寄线路</option>
                                <option value="19">优选EMS个人快件</option>
                                <option value="18">EMS个人快件</option>
                                <option value="12">顺丰个人快件</option>
                                <option value="11">香港E特快</option>
                        </select>
                        <i class="layui-edge"></i>
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-form-item layui-hide">
            <input type="button" lay-submit lay-filter="layuiadmin-app-form-submit" id="layuiadmin-app-form-submit" value="确认添加">
            <input type="button" lay-submit lay-filter="layuiadmin-app-form-edit" id="layuiadmin-app-form-edit" value="确认编辑">
        </div>
    </div>

    <div class="ordbody">
        <div class="obconts">
            <p>身份证国徽面</p>
            <img src="http://ores.meiquick.com/webuser/Member/images/pho_front.png" id="fileimage2" style="width: 230px;height: 120px;margin-left: 15px;">
            <input type="file" name="id_card_front" class="uploadfile" id="files" accept="image/jpeg,image/jpg,image/png" atd="2" onclick="fileOnchange(this)">
            <label>上传图片</label>
        </div>
        <div class="obconts">
            <p>身份证头像面</p>
            <img src="http://ores.meiquick.com/webuser/Member/images/pho_back.png" id="fileimage1" style="width: 230px;height: 120px;margin-left: 15px;">
            <input type="file" name="id_card_back" class="uploadfile" id="file" accept="image/jpeg,image/jpg,image/png" atd="1" onclick="fileOnchange(this)">
            <label>上传图片</label>
        </div>
    </div>
    <div style="clear:both;"></div>
</form>

<script src="{{asset('js/layui.js')}}"></script>
<script>
    layui.config({
        base: '/js/admin/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'form'], function(){
        var $ = layui.$
                ,form = layui.form;

        form.verify({
            chinese: function(value){ //value：表单的值、item：表单的DOM对象
                var re = /^[\u4E00-\u9FA5]{1,10}$/;
                if(!re.test(value)) {
                    return '请输入1-10个中文字符';
                }
            },

        });

        //监听提交
        form.on('submit(layuiadmin-app-form-submit)', function(data){
            var field = data.field; //获取提交的字段
            var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
            //post(data.field,index);
            $('#form1').ajaxForm({
                dataType: 'json',
                success : function(result) {
                    layer.alert(result.msg);
                    if (result.status == 200){
                        parent.layui.table.reload('list-index'); //重载表格
                        parent.layer.close(index); //再执行关闭
                    }else{
                        layer.msg(result.msg);
                    }
                },
                error: function (error) {
                    var errors = error.responseJSON.errors;
                    $.each(errors, function (key, value) {
                        layer.msg(value[0]);
                        return false;
                    });
                }
            });
            return false;
        });

        $("select").on('click',function () {
            if ($(this).parent().parent().hasClass("layui-form-selected")){
                $(this).parent().parent().removeClass("layui-form-selected");
            }else{
                $(this).parent().parent().addClass("layui-form-selected");
            }
        });
    })
</script>
<script src="http://ores.meiquick.com/webuser/Ace/js/jquery-1.8.3.min.js"></script>
<script src="{{asset('js/jquery.form.js')}}"></script>
<script>
    function a(){
        alert(1)
    }
    function fileOnchange(pid){
        var atd = pid.getAttribute("atd");
        // alert(atd);
        var input = pid;

        var res = document.getElementById("fileimage"+atd);
        if(typeof FileReader==='undefined'){
            res.innerHTML = "抱歉，你的浏览器不支持 FileReader";
            input.setAttribute('disabled','disabled');
        }else{
            input.addEventListener('change',readFile,false);
        }

        //图片文件读取
        function readFile(){
            var file = this.files[0];
            // console.log(file);
            if(!/image\/\w+/.test(file.type)){
                layer.open({
                    type: 0,
                    title: false,
                    content: "文件必须为图片！"
                });
                return false;
            }
            var reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = function(e){
                res.src = this.result;  //赋值到src
            }
        }
    }

    function post(data,index){
        //提交 Ajax 成功后，关闭当前弹层

    }
</script>
</body>
</html>